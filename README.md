<!-- README.md is generated from README.Rmd. Please edit that file -->
mpoly
=====

Specifying polynomials
----------------------

**mpoly** is a simple collection of tools to help deal with multivariate polynomials *symbolically* and functionally in R. Polynomials are defined with the `mp` function:

``` r
library(mpoly)
#> Loading required package: stringr
mp("x + y")
#> x  +  y
mp("(x + 4y)^2 (x - .25)")
#> x^3  -  0.25 x^2  +  8 x^2 y  -  2 x y  +  16 x y^2  -  4 y^2
```

[Term orders](http://en.wikipedia.org/wiki/Lexicographical_order#Monomials) are available with the reorder function:

``` r
(p <- mp("(x + y)^2 (1 + x)"))
#> x^3  +  x^2  +  2 x^2 y  +  2 x y  +  x y^2  +  y^2
reorder(p, varorder = c('y','x'), order = 'lex')
#> y^2 x  +  y^2  +  2 y x^2  +  2 y x  +  x^3  +  x^2
reorder(p, varorder = c('x','y'), order = 'glex')
#> x^3  +  2 x^2 y  +  x y^2  +  x^2  +  2 x y  +  y^2
```

Vectors of polynomials (`mpolyList`s) can be specified in the same way:

``` r
mp(c("(x+y)^2", "z"))
#> x^2  +  2 x y  +  y^2
#> z
```

Polynomial arithmetic
---------------------

Arithmetic is defined for both polynomials (`+`, `-`, `*` and `^`)...

``` r
p1 <- mp("x + y")
p2 <- mp("x - y")

p1 + p2
#> 2 x
p1 - p2
#> 2 y
p1 * p2
#> x^2  -  y^2
p1^2
#> x^2  +  2 x y  +  y^2
```

... and vectors of polynomials:

``` r
(ps1 <- mp(c("x", "y")))
#> x
#> y
(ps2 <- mp(c("2x", "y+z")))
#> 2 x
#> y  +  z
ps1 + ps2
#> 3 x
#> 2 y  +  z
ps1 - ps2
#> -1 x
#> -1 z
ps1 * ps2
#> 2 x^2
#> y^2  +  y z
```

Some calculus
-------------

You can compute derivatives easily:

``` r
p <- mp("x + x y + x y^2")
deriv(p, "y")
#> x  +  2 x y
gradient(p)
#> y  +  y^2  +  1
#> x  +  2 y x
```

Function coercion
-----------------

You can turn polynomials and vectors of polynomials into functions you can evaluate with `as.function()`. For example, you can visualize a univariate polynomials like this:

``` r
f <- as.function(mp("(x-2) x (x+2)"))
#> f(x)
s <- seq(-2.5, 2.5, .1)
df <- expand.grid(x = s)
df$f <- apply(df, 1, f)

library(ggplot2); theme_set(theme_bw())
qplot(x, f, data = df, geom = "line")
```

![](README-unnamed-chunk-7-1.png)

Or a bivariate polynomial like this:

``` r
f <- as.function(mp("x^2 - y^2")) 
#> f(.) with . = (x, y)
df <- expand.grid(x = s, y = s)
df$f <- apply(df, 1, f)
qplot(x, y, data = df, geom = "tile", fill = f)
```

![](README-unnamed-chunk-8-1.png)

Algebraic geometry
------------------

Grobner bases computations are available using **rSymPy**:

``` r
polys <- mp(c("t^4 - x", "t^3 - y", "t^2 - z"))
grobner(polys)
#> using variable ordering - t, x, y, z
#> Loading required package: rJava
#> -1 z  +  t^2
#> t y  -  z^2
#> -1 y  +  z t
#> x  -  z^2
#> y^2  -  z^3
```

Special polynomials
-------------------

You can construct [Chebyshev polynomials](http://en.wikipedia.org/wiki/Chebyshev_polynomials) as follows:

``` r
chebyshev(1)
#> x
chebyshev(2)
#> 2 x^2  -  1
chebyshev(0:5)
#> 1
#> x
#> 2 x^2  -  1
#> 4 x^3  -  3 x
#> 8 x^4  -  8 x^2  +  1
#> 16 x^5  -  20 x^3  +  5 x
```

And you can visualize them:

``` r
library(reshape2)

s <- seq(-1, 1, length.out = 201)
N <- 5 # number of chebyshev polynomials to plot
(chebPolys <- chebyshev(0:N))
#> 1
#> x
#> 2 x^2  -  1
#> 4 x^3  -  3 x
#> 8 x^4  -  8 x^2  +  1
#> 16 x^5  -  20 x^3  +  5 x

df <- t(sapply(s, as.function(chebPolys)) )
#> f(x)
df <- as.data.frame(cbind(s, df))
names(df) <- c("x", paste0("T_", 0:N))
mdf <- melt(df, id = "x")
qplot(x, value, data = mdf, geom = "line", color = variable)
```

![](README-unnamed-chunk-11-1.png)

[Bernstein polynomials](http://en.wikipedia.org/wiki/Bernstein_polynomial) are available with `bernstein()`:

``` r
bernstein(0:4, 4)
#> x^4  -  4 x^3  +  6 x^2  -  4 x  +  1
#> -4 x^4  +  12 x^3  -  12 x^2  +  4 x
#> 6 x^4  -  12 x^3  +  6 x^2
#> -4 x^4  +  4 x^3
#> x^4

s <- seq(0, 1, length.out = 101)
N <- 5 # number of bernstein polynomials to plot
(bernPolys <- bernstein(0:N, N))
#> -1 x^5  +  5 x^4  -  10 x^3  +  10 x^2  -  5 x  +  1
#> 5 x^5  -  20 x^4  +  30 x^3  -  20 x^2  +  5 x
#> -10 x^5  +  30 x^4  -  30 x^3  +  10 x^2
#> 10 x^5  -  20 x^4  +  10 x^3
#> -5 x^5  +  5 x^4
#> x^5

df <- t(sapply(s, as.function(bernPolys)) )
#> f(x)
df <- as.data.frame(cbind(s, df))
names(df) <- c("x", paste0("B_", 0:N))
mdf <- melt(df, id = "x")
qplot(x, value, data = mdf, geom = "line", color = variable)
```

![](README-unnamed-chunk-12-1.png)

You can use the `bernsteinApprox()` function to compute the Bernstein polynomial approximation to a function. Here's an approximation to the standard normal density:

``` r
p <- bernsteinApprox(dnorm, 15, -1.25, 1.25)
round(p, 4)
#> 0.0001 x^8  -  0.002 x^6  +  0.0262 x^4  -  0.1624 x^2  +  0.3796

x <- seq(-3, 3, length.out = 101)
df <- data.frame(
  x = rep(x, 2),
  y = c(dnorm(x), as.function(p)(x)),
  which = rep(c("actual", "approx"), each = 101)
)
#> f(x)
qplot(x, y, data = df, geom = "line", color = which)
```

![](README-unnamed-chunk-13-1.png)

Bezier polynomials and curves
-----------------------------

You can construct [Bezier polynomials](http://en.wikipedia.org/wiki/BÃ©zier_curve) for a given collection of points with `bezier()`:

``` r
points <- data.frame(x = c(-1,-2,2,1), y = c(0,1,1,0))
(bezPolys <- bezier(points))
#> -10 t^3  +  15 t^2  -  3 t  -  1
#> -3 t^2  +  3 t
```

And viewing them is just as easy:

``` r
df <- t(sapply(s, as.function(bezPolys)) )
#> f(t)
df <- as.data.frame(df)
names(df) <- c("x", "y")
qplot(x, y, data = df, geom = "path") +
  geom_path(data = points, color = "red") +
  geom_point(data = points, color = "red", size = 4)
```

![](README-unnamed-chunk-15-1.png)

Other stuff
-----------

I'm starting to put in methods for some other R functions:

``` r
n <- 101
df <- data.frame(x = seq(-5, 5, length.out = n))
df$y <- with(df, -x^2 + 2*x - 3 + rnorm(n, 0, 2))

mod <- lm(y ~ x + I(x^2), data = df)
(p <- round(as.mpoly(mod)))
#> 1.967 x  -  0.988 x^2  -  2.867
qplot(x, y, data = df) +
  stat_function(fun = as.function(p), colour = 'red')
#> f(x)
```

![](README-unnamed-chunk-16-1.png)

``` r


df <- df %>% dplyr::arrange(x)
bezier(df)
#> 28872395762264 t^100  -  5550227924394919 t^99  +  257524164448643584 t^98  -  5486432867534512128 t^97  +  86208461136174137344 t^96  -  973010044920159272960 t^95  +  8952262427000620187648 t^94  -  67665901937709090340864 t^93  +  413990207181983714377728 t^92  -  2169648063017396838858752 t^91  +  10215623171201757442211840 t^90  -  39429210673083588267737088 t^89  +  150081716298764745747464192 t^88  -  473299688194303653230673920 t^87  +  1348855346913026284370001920 t^86  -  3156830666010080949250818048 t^85  +  6855660878345967534732214272 t^84  -  13080372818096327189527003136 t^83  +  20394058314951326409859006464 t^82  -  27256940070137478833571364864 t^81  +  6459914346417121991722008576 t^80  +  103388391896093539120996941824 t^79  -  219369275208381341256969617408 t^78  +  529849505358297756001170882560 t^77  -  783428481883374495840442777600 t^76  +  743090679812620047625041739776 t^75  -  558818244850077171250341347328 t^74  -  588500412268868497049934364672 t^73  +  3075636049710386057135895085056 t^72  -  7954610812548359449273008390144 t^71  +  13677856902254243196614922469376 t^70  -  22742902163759437548928928579584 t^69  +  29929099021496484473668200562688 t^68  -  40005171731953237029066377265152 t^67  +  47864067339349913582343674658816 t^66  -  51094400443405685832525870530560 t^65  +  51957289803458760243366821101568 t^64  -  48565193792952596399581174956032 t^63  +  43648217566029392046514679840768 t^62  -  34783739347831105551196491874304 t^61  +  28524044080840596297641296396288 t^60  -  20172097643046226110678755704832 t^59  +  14199159114177952601400772919296 t^58  -  8752251235151295733634829385728 t^57  +  5404985595102540094976567541760 t^56  -  3070974734811738428743587201024 t^55  +  1645724795326103330266139328512 t^54  -  788503307288013844192474169344 t^53  +  360516598093264815070812045312 t^52  -  192040539511304517416065695744 t^51  +  66611726612375980764529950720 t^50  -  22841552835608605503606751232 t^49  +  10698167749078122504405385216 t^48  -  2905945292218340066841329664 t^47  +  902063553696400928183156736 t^46  -  154027121108748591477817344 t^45  +  45438717983452145232379904 t^44  +  42490471362746196848279552 t^43  -  8260557059996748884213760 t^42  -  3680409646682820482957312 t^41  +  611482392671321338150912 t^40  +  314313161988459437490176 t^39  -  223528014571938540158976 t^38  +  27122143965670591692800 t^37  +  179189880031526518784 t^36  -  1379147002511253045248 t^35  -  734604924935349469184 t^34  -  379871758682612039680 t^33  -  23546653524482850816 t^32  +  3419556788167507968 t^31  +  57207736022073344 t^30  +  509180901360402432 t^29  +  80997336536317952 t^28  -  862389167718400 t^27  +  2496312570281984 t^26  +  628358949896192 t^25  -  139691160502272 t^24  -  22050261434368 t^23  -  1118587322368 t^22  +  250315014144 t^21  -  18695323648 t^20  +  10307043328 t^19  -  1029865472 t^18  +  80531456 t^17  -  24364032 t^16  +  514688 t^15  +  36608 t^14  +  6776 t^13  -  1372 t^12  +  4 t^11  -  0.1240234 t^9  +  0.0078125 t^8  +  0.00006103516 t^7  -  0.0000004768372 t^5  +  10 t  -  5
#> 953447944150441057472508592128 t^100  -  49628401649238495812538297483264 t^99  +  1272825330165898451075466239410176 t^98  -  21432705324160650669075456424148992 t^97  +  266408645944620687529820819403309056 t^96  -  2606000727456894166591865427255623680 t^95  +  20886963295292035614170305320340946944 t^94  -  141029182402916404025556821058422571008 t^93  +  818638844093169084688045199731260915712 t^92  -  4149254562471328688331124608677724553216 t^91  +  18590539077113182386313030228635004436480 t^90  -  74376282111467527527488961273141294792704 t^89  +  267965520024292024285571474429556796948480 t^88  -  875800299898913574264505847784643883958272 t^87  +  2613553204690580939362308401929817595838464 t^86  -  7163406704467147223308315759428515059990528 t^85  +  18132376008161442643087918865796553783640064 t^84  -  42609100410391506825692862216087546001096704 t^83  +  93421319575730433899017668691294511807070208 t^82  -  192043796130156443928669773212825390617198592 t^81  +  371875794033726464580832530984430672677961728 t^80  -  681315160362074850006664318564036777930129408 t^79  +  1185686129942261801869640534701629910185672704 t^78  -  1966577112969358954074745400935023438326661120 t^77  +  3116533837907749693664011415267317038798864384 t^76  -  4726640578940475104563620966117303644783116288 t^75  +  6865033925051299706646822567102611083361255424 t^74  -  9546731817648635490688795155840318931927564288 t^73  +  12699669047367582775204005725098507752655814656 t^72  -  16137403849394094692254058199809088980376354816 t^71  +  19552765976616480811297108836043765427656982528 t^70  -  22545216209287340791958295263826104417087651840 t^69  +  24685849192581518413345501936082076582532874240 t^68  -  25609460880390490152638331190442072769331986432 t^67  +  25108709482135052421940904625354026777533480960 t^66  -  23198723743105241325514004356125530227663175680 t^65  +  20126726702266085545846294074194666148839030784 t^64  -  16319439640395120330837721097524089326044971008 t^63  +  12283782438837408308258929587189121321057386496 t^62  -  8493297738102239878401216241921886078139105280 t^61  +  5296063253172831525782812120281333088433209344 t^60  -  2868765756932356028921265811634224208399040512 t^59  +  1222277847598885846912908706530466305065091072 t^58  -  245891959625468612007014486715269615733178368 t^57  -  232287295842168441750468091106856867228286976 t^56  +  390357412703896168441077302214866167043981312 t^55  -  376221612537073734409831755804563295736692736 t^54  +  292651634819039726758863964605536589037174784 t^53  -  199056939068561385377216534177465659551645696 t^52  +  122168650868839646270419001404882924773310464 t^51  -  68683732902329046923474188176902029750304768 t^50  +  35649781991297491643433405396089872796614656 t^49  -  17147964388812776715899566141677245218947072 t^48  +  7651398220974774094849176365129839505571840 t^47  -  3161883700992091812503142943802568845819904 t^46  +  1204460413830116600780381819751707082489856 t^45  -  418982620347462563179264421257814967582720 t^44  +  130678394164737622645277487702160246308864 t^43  -  35134265168745041893478770178285453180928 t^42  +  7306352441624313478732098365540410589184 t^41  -  633717535706352003089595184775012810752 t^40  -  404726420587988407981686274803776880640 t^39  +  311576597405288072736657114262673555456 t^38  -  144300467291071800823543479711498764288 t^37  +  54006617059568270807556601938456870912 t^36  -  17564193129376455921658578415940272128 t^35  +  5106165690903510195411799173060624384 t^34  -  1344719253433501846888795205592416256 t^33  +  323068179520179052321836996665278464 t^32  -  71118080214328538273621716601143296 t^31  +  14400261665738843041550597017829376 t^30  -  2696460830571243598864734882889728 t^29  +  471265794955592333316237664714752 t^28  -  78102950875259662633285304975360 t^27  +  12570676189700534045546054156288 t^26  -  2020619794539670465556900741120 t^25  +  330986170000309341931408719872 t^24  -  55252089826731913602540765184 t^23  +  9219822850585982215863140352 t^22  -  1498718094606121530338312192 t^21  +  232252302923985932875988992 t^20  -  33809459723713781595897856 t^19  +  4578011227519415249534976 t^18  -  572341211554706211471360 t^17  +  65647043123345904107520 t^16  -  6869865820290383085568 t^15  +  652989657222783565824 t^14  -  56189277581563265024 t^13  +  4365348781548144640 t^12  -  305093000570012608 t^11  +  19050632926285788 t^10  -  1049422845070554 t^9  +  49966870297368 t^8  -  1998660017546 t^7  +  65085431860 t^6  -  1704077581 t^5  +  38003614 t^4  -  820578.4 t^3  +  17579.2 t^2  -  224.6585 t  -  34.78268
```

Installation
------------

-   From CRAN: `install.packages("mpoly")`

-   From Github (dev version):

    ``` r
    # install.packages("devtools")
    devtools::install_github("Rexamine/stringi")
    devtools::install_github("hadley/stringr")
    devtools::install_github("dkahle/mpoly")
    ```
